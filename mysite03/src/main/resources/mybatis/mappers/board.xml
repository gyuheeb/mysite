<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">
	
	<select id="findAll" resultType="boardvo">
	<![CDATA[
		select a.no,a.title,a.contents,a.hit,a.reg_date,a.g_no,a.o_no,a.depth,a.user_no,b.name 
		from board a,user b where a.user_no=b.no order by g_no desc,o_no asc
	]]>
	</select>
	
	<select id="getContents"  parameterType="Long" resultType="boardvo">
	<![CDATA[
		select a.no,a.title,a.contents,a.hit,a.reg_date,a.g_no,a.o_no,a.depth,a.user_no,b.name 
		from board a,user b where a.user_no=b.no and b.no=#{no}
	]]>
	</select>
	
<!-- 

	<select id="findAllByPageAndKeyword" parameterType="map">
		<![CDATA[
		select *
		  from board
		 where title like '%${keyword }%'
		    or contents like '%${keyword }%'
		 limit #{startOffset }, #{size }    
		]]>
	</select>

	<insert id="insert" parameterType="boardvo">
	<![CDATA[
		insert into board(no,title,contents,reg_date,g_no,o_no,depth,user_no) values(null,#{title }, #{contents }, now(),#{g_no },#{o_no },#{depth },#{user_no })
	]]>
	
	<selectKey keyProperty="no" resultType="Long" order="AFTER">
		<![CDATA[
			select last_insert_id()
			]]>
	</selectKey>
	</insert>
 -->
 
	








	<select id="findAllByPageAndKeyWord" parameterType="map">
	<choose>
		<when test="keyword== null || keyword ==''">
		
		</when>
		<otherwise>
		
		</otherwise>
	</choose>
	<![CDATA[
		select * from board where title like '%${keyword }%' or contents like '%${keyword }%'
		limit #{startOffset},#{size}
		
	]]>
	</select>
	
	<select id="getTotalCount" parameterType="string" resultType="integer">
	
	<choose>
		<when test='_parameter == null or _parameter==""'>
			<![CDATA[
				select count(*) from board  
			]]>
		
		</when>
		<otherwise>
			<![CDATA[
				select count(*) from board where title like '%${keyword }%' or contents like '%${keyword }%'
			]]>
		</otherwise>
		</choose>
		</select>
	

	</mapper>